<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constrained Hierarchical Model - Architecture Comparison</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 10px;
        }

        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .comparison-container {
            display: flex;
            gap: 20px;
            margin-bottom: 40px;
        }

        .model-column {
            flex: 1;
            border: 2px solid #ddd;
            border-radius: 12px;
            padding: 20px;
            background: #fafafa;
        }

        .model-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ddd;
        }

        .standard-model {
            border-color: #ff6b6b;
        }

        .constrained-model {
            border-color: #51cf66;
        }

        svg {
            width: 100%;
            height: auto;
        }

        .embedding-box {
            fill: #e3f2fd;
            stroke: #1976d2;
            stroke-width: 2;
            rx: 8;
        }

        .concat-box {
            fill: #fff3e0;
            stroke: #f57c00;
            stroke-width: 2;
            rx: 8;
        }

        .feature-box {
            fill: #e8f5e9;
            stroke: #388e3c;
            stroke-width: 2;
            rx: 8;
        }

        .linear-box {
            fill: #fce4ec;
            stroke: #c2185b;
            stroke-width: 2;
            rx: 8;
        }

        .constrained-linear-box {
            fill: #f3e5f5;
            stroke: #7b1fa2;
            stroke-width: 3;
            rx: 8;
        }

        .param-box {
            fill: #fff9c4;
            stroke: #f57f17;
            stroke-width: 2;
            rx: 6;
        }

        .transform-box {
            fill: #e1bee7;
            stroke: #8e24aa;
            stroke-width: 2;
            rx: 6;
        }

        .weight-box {
            fill: #c5e1a5;
            stroke: #558b2f;
            stroke-width: 2;
            rx: 6;
        }

        .output-box {
            fill: #ffccbc;
            stroke: #d84315;
            stroke-width: 2;
            rx: 8;
        }

        .warning-box {
            fill: #ffebee;
            stroke: #c62828;
            stroke-width: 2;
            rx: 6;
            stroke-dasharray: 4, 2;
        }

        .success-box {
            fill: #e8f5e9;
            stroke: #2e7d32;
            stroke-width: 2;
            rx: 6;
        }

        .label {
            font-size: 11px;
            font-weight: 600;
            fill: #333;
            text-anchor: middle;
        }

        .label-large {
            font-size: 13px;
            font-weight: 700;
            fill: #333;
            text-anchor: middle;
        }

        .dim-label {
            font-size: 9px;
            fill: #666;
            text-anchor: middle;
        }

        .formula {
            font-size: 10px;
            fill: #555;
            text-anchor: middle;
            font-family: 'Courier New', monospace;
        }

        .section-title {
            font-size: 12px;
            font-weight: bold;
            fill: #333;
            text-anchor: middle;
        }

        .arrow-forward {
            stroke: #666;
            stroke-width: 2;
            fill: none;
            marker-end: url(#arrowhead);
        }

        .arrow-transform {
            stroke: #8e24aa;
            stroke-width: 2.5;
            fill: none;
            marker-end: url(#arrowhead-purple);
        }

        .arrow-constraint {
            stroke: #2e7d32;
            stroke-width: 2.5;
            fill: none;
            marker-end: url(#arrowhead-green);
        }

        .detail-box {
            background: #f5f5f5;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin-top: 30px;
        }

        .detail-title {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #ddd;
        }

        .code-block {
            background: #263238;
            color: #aed581;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            overflow-x: auto;
            margin: 10px 0;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background: #667eea;
            color: white;
            font-weight: bold;
        }

        .comparison-table tr:nth-child(even) {
            background: #f9f9f9;
        }

        .badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: bold;
        }

        .badge-positive {
            background: #c8e6c9;
            color: #2e7d32;
        }

        .badge-negative {
            background: #ffcdd2;
            color: #c62828;
        }

        .badge-unconstrained {
            background: #fff9c4;
            color: #f57f17;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Constrained Hierarchical Model Architecture</h1>
        <p class="subtitle">Comparison: Standard Linear Layer vs. Constrained Linear Layer with Business Logic</p>

        <!-- Side-by-Side Comparison -->
        <div class="comparison-container">
            <!-- Standard Model -->
            <div class="model-column standard-model">
                <div class="model-title">‚ùå Standard Model (Unconstrained)</div>
                <svg viewBox="0 0 500 700">
                    <defs>
                        <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
                        </marker>
                    </defs>

                    <!-- Embeddings -->
                    <rect x="150" y="30" width="200" height="60" class="concat-box" />
                    <text x="250" y="55" class="label-large">All Embeddings</text>
                    <text x="250" y="75" class="dim-label">(35 dimensions)</text>

                    <!-- Features -->
                    <rect x="150" y="120" width="200" height="60" class="feature-box" />
                    <text x="250" y="145" class="label-large">Features (x)</text>
                    <text x="250" y="165" class="dim-label">(12 features)</text>

                    <!-- Concatenation -->
                    <rect x="180" y="210" width="140" height="50" class="concat-box" />
                    <text x="250" y="235" class="label">Concat</text>
                    <text x="250" y="250" class="dim-label">(47 total)</text>

                    <!-- Arrow -->
                    <path d="M 250 90 L 250 115" class="arrow-forward" />
                    <path d="M 250 180 L 250 205" class="arrow-forward" />

                    <!-- Standard Linear Layer -->
                    <rect x="150" y="290" width="200" height="80" class="linear-box" />
                    <text x="250" y="318" class="label-large">Standard Linear Layer</text>
                    <text x="250" y="340" class="formula">W: 47 √ó 1 (unconstrained)</text>
                    <text x="250" y="358" class="formula">bias: 1</text>

                    <!-- Arrow -->
                    <path d="M 250 260 L 250 285" class="arrow-forward" />

                    <!-- Weight Warning -->
                    <rect x="80" y="400" width="340" height="90" class="warning-box" />
                    <text x="250" y="425" class="label" style="fill: #c62828;">‚ö†Ô∏è Weights can be ANY value</text>
                    <text x="250" y="445" class="dim-label">‚Ä¢ Temperature weight: could be -0.5 ‚ùå</text>
                    <text x="250" y="460" class="dim-label">‚Ä¢ Unemployment weight: could be +2.3 ‚ùå</text>
                    <text x="250" y="475" class="dim-label">‚Ä¢ Price weight: could be +1.8 ‚ùå</text>

                    <!-- Output -->
                    <rect x="180" y="520" width="140" height="50" class="output-box" />
                    <text x="250" y="545" class="label-large">Prediction</text>
                    <text x="250" y="560" class="dim-label">≈∑ = W¬∑x + b</text>

                    <!-- Arrow -->
                    <path d="M 250 370 L 250 515" class="arrow-forward" />

                    <!-- Problem Summary -->
                    <rect x="80" y="600" width="340" height="80" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="6" />
                    <text x="250" y="625" class="label" style="fill: #e65100;">Issues:</text>
                    <text x="250" y="645" class="dim-label">‚úó Violates business logic</text>
                    <text x="250" y="660" class="dim-label">‚úó Hard to interpret/trust</text>
                    <text x="250" y="675" class="dim-label">‚úó May overfit to noise</text>
                </svg>
            </div>

            <!-- Constrained Model -->
            <div class="model-column constrained-model">
                <div class="model-title">‚úÖ Constrained Model (Business Logic)</div>
                <svg viewBox="0 0 500 700">
                    <defs>
                        <marker id="arrowhead-purple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#8e24aa" />
                        </marker>
                        <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                            <polygon points="0 0, 10 3.5, 0 7" fill="#2e7d32" />
                        </marker>
                    </defs>

                    <!-- Embeddings -->
                    <rect x="150" y="30" width="200" height="60" class="concat-box" />
                    <text x="250" y="55" class="label-large">All Embeddings</text>
                    <text x="250" y="75" class="dim-label">(35 dimensions)</text>

                    <!-- Features -->
                    <rect x="150" y="120" width="200" height="60" class="feature-box" />
                    <text x="250" y="145" class="label-large">Features (x)</text>
                    <text x="250" y="165" class="dim-label">(12 features)</text>

                    <!-- Concatenation -->
                    <rect x="180" y="210" width="140" height="50" class="concat-box" />
                    <text x="250" y="235" class="label">Concat</text>
                    <text x="250" y="250" class="dim-label">(47 total)</text>

                    <!-- Arrow -->
                    <path d="M 250 90 L 250 115" class="arrow-forward" />
                    <path d="M 250 180 L 250 205" class="arrow-forward" />

                    <!-- Constrained Linear Layer -->
                    <rect x="130" y="290" width="240" height="100" class="constrained-linear-box" />
                    <text x="250" y="318" class="label-large">Constrained Linear Layer</text>
                    <text x="250" y="338" class="dim-label">Learn unconstrained params Œ∏</text>
                    <text x="250" y="355" class="dim-label">Transform ‚Üí valid weights W</text>
                    <text x="250" y="372" class="formula">W = f(Œ∏) with constraints</text>

                    <!-- Arrow -->
                    <path d="M 250 260 L 250 285" class="arrow-forward" />

                    <!-- Transformation Detail (expanded) -->
                    <rect x="50" y="420" width="400" height="110" class="success-box" />
                    <text x="250" y="445" class="label" style="fill: #2e7d32;">‚úì Enforced Constraints</text>
                    <text x="250" y="465" class="formula">temp: softplus(Œ∏‚ÇÄ) ‚â• 0 ‚úì</text>
                    <text x="250" y="482" class="formula">precip: -softplus(Œ∏‚ÇÅ) ‚â§ 0 ‚úì</text>
                    <text x="250" y="499" class="formula">unemp: -softplus(Œ∏‚ÇÉ) ‚â§ 0 ‚úì</text>
                    <text x="250" y="516" class="formula">All spends: softplus(Œ∏·µ¢) ‚â• 0 ‚úì</text>

                    <!-- Output -->
                    <rect x="180" y="560" width="140" height="50" class="output-box" />
                    <text x="250" y="585" class="label-large">Prediction</text>
                    <text x="250" y="600" class="dim-label">≈∑ = W(Œ∏)¬∑x + b</text>

                    <!-- Arrow -->
                    <path d="M 250 390 L 250 555" class="arrow-transform" />

                    <!-- Benefits Summary -->
                    <rect x="80" y="630" width="340" height="60" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="6" />
                    <text x="250" y="655" class="label" style="fill: #1565c0;">Benefits:</text>
                    <text x="250" y="673" class="dim-label">‚úì Respects business rules ‚úì Interpretable ‚úì Robust</text>
                </svg>
            </div>
        </div>

        <!-- Detailed Flow Diagram -->
        <div class="detail-box">
            <div class="detail-title">üîç Detailed Flow: How Constrained Layer Works</div>

            <svg viewBox="0 0 1400 500">
                <defs>
                    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#666" />
                    </marker>
                    <marker id="arrowhead-purple2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#8e24aa" />
                    </marker>
                    <marker id="arrowhead-green2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                        <polygon points="0 0, 10 3.5, 0 7" fill="#2e7d32" />
                    </marker>
                </defs>

                <!-- Step 1: Learnable Parameters -->
                <text x="100" y="30" class="section-title">Step 1: Learnable Params (Œ∏)</text>
                <rect x="20" y="50" width="160" height="180" class="param-box" />
                <text x="100" y="75" class="label">Unconstrained Œ∏</text>
                <text x="100" y="95" class="formula">Œ∏‚ÇÄ = 0.5 (temp)</text>
                <text x="100" y="115" class="formula">Œ∏‚ÇÅ = -1.2 (precip)</text>
                <text x="100" y="135" class="formula">Œ∏‚ÇÇ = 2.3 (gdp)</text>
                <text x="100" y="155" class="formula">Œ∏‚ÇÉ = 0.8 (unemp)</text>
                <text x="100" y="175" class="formula">Œ∏‚ÇÑ = -0.4 (cci)</text>
                <text x="100" y="195" class="formula">...</text>
                <text x="100" y="218" class="dim-label">Can be any value!</text>

                <!-- Step 2: Transformation Functions -->
                <text x="350" y="30" class="section-title">Step 2: Apply Transformations</text>
                <rect x="220" y="50" width="260" height="180" class="transform-box" />
                <text x="350" y="75" class="label">Transform f(Œ∏)</text>
                <text x="350" y="100" class="formula">Positive: softplus(Œ∏)</text>
                <text x="350" y="120" class="formula">= log(1 + exp(Œ∏))</text>
                <text x="350" y="145" class="formula">Negative: -softplus(Œ∏)</text>
                <text x="350" y="165" class="formula">= -log(1 + exp(Œ∏))</text>
                <text x="350" y="190" class="dim-label">Advanced options:</text>
                <text x="350" y="208" class="dim-label">sigmoid, bounded ranges, curves</text>

                <!-- Arrow -->
                <path d="M 180 140 L 215 140" class="arrow-transform" stroke-width="3" marker-end="url(#arrowhead-purple2)" />

                <!-- Step 3: Constrained Weights -->
                <text x="600" y="30" class="section-title">Step 3: Valid Weights (W)</text>
                <rect x="520" y="50" width="160" height="180" class="weight-box" />
                <text x="600" y="75" class="label">Constrained W</text>
                <text x="600" y="95" class="formula">w‚ÇÄ = +1.65 ‚úì</text>
                <text x="600" y="115" class="formula">w‚ÇÅ = -2.49 ‚úì</text>
                <text x="600" y="135" class="formula">w‚ÇÇ = +10.08 ‚úì</text>
                <text x="600" y="155" class="formula">w‚ÇÉ = -2.23 ‚úì</text>
                <text x="600" y="175" class="formula">w‚ÇÑ = +0.67 ‚úì</text>
                <text x="600" y="195" class="formula">...</text>
                <text x="600" y="218" class="dim-label">Always valid!</text>

                <!-- Arrow -->
                <path d="M 480 140 L 515 140" class="arrow-constraint" stroke-width="3" marker-end="url(#arrowhead-green2)" />

                <!-- Step 4: Multiply with Features -->
                <text x="820" y="30" class="section-title">Step 4: Multiply with x</text>
                <rect x="720" y="50" width="200" height="180" class="feature-box" />
                <text x="820" y="75" class="label">Element-wise: W ‚äô x</text>
                <text x="820" y="100" class="formula">w‚ÇÄ √ó x‚ÇÄ (temp)</text>
                <text x="820" y="120" class="formula">w‚ÇÅ √ó x‚ÇÅ (precip)</text>
                <text x="820" y="140" class="formula">w‚ÇÇ √ó x‚ÇÇ (gdp)</text>
                <text x="820" y="160" class="formula">...</text>
                <text x="820" y="185" class="dim-label">Each feature</text>
                <text x="820" y="202" class="dim-label">contributes correctly</text>

                <!-- Arrow -->
                <path d="M 680 140 L 715 140" class="arrow-forward" stroke-width="3" marker-end="url(#arrowhead2)" />

                <!-- Step 5: Sum and Output -->
                <text x="1080" y="30" class="section-title">Step 5: Sum + Bias</text>
                <rect x="960" y="80" width="240" height="120" class="output-box" />
                <text x="1080" y="110" class="label-large">Prediction ≈∑</text>
                <text x="1080" y="135" class="formula">≈∑ = Œ£(w·µ¢ √ó x·µ¢) + b</text>
                <text x="1080" y="160" class="dim-label">Business-compliant</text>
                <text x="1080" y="178" class="dim-label">& interpretable!</text>

                <!-- Arrow -->
                <path d="M 920 140 L 955 140" class="arrow-forward" stroke-width="3" marker-end="url(#arrowhead2)" />

                <!-- Backward Pass Annotation -->
                <rect x="20" y="260" width="1180" height="80" fill="#fff8e1" stroke="#ff8f00" stroke-width="2" rx="8" stroke-dasharray="4,2" />
                <text x="610" y="285" class="section-title">üîÑ During Backpropagation:</text>
                <text x="610" y="310" class="dim-label">1. Gradients flow: ‚àÇL/‚àÇ≈∑ ‚Üí ‚àÇL/‚àÇW ‚Üí ‚àÇL/‚àÇŒ∏</text>
                <text x="610" y="328" class="dim-label">2. Update unconstrained params: Œ∏ ‚Üê Œ∏ - Œ∑¬∑‚àÇL/‚àÇŒ∏</text>

                <!-- Key Insight -->
                <rect x="20" y="365" width="1180" height="120" fill="#e8eaf6" stroke="#3949ab" stroke-width="2" rx="8" />
                <text x="610" y="395" class="section-title">üí° Key Insight: Why This Works</text>
                <text x="610" y="420" class="dim-label">‚Ä¢ Optimizer sees unconstrained Œ∏ (can be any value) ‚Üí learns freely</text>
                <text x="610" y="440" class="dim-label">‚Ä¢ Model uses constrained W (transformed Œ∏) ‚Üí always valid for business</text>
                <text x="610" y="460" class="dim-label">‚Ä¢ Transformation is differentiable (softplus, sigmoid) ‚Üí gradients flow smoothly</text>
                <text x="610" y="475" class="dim-label">‚Ä¢ No "fighting" between optimizer and constraints!</text>
            </svg>
        </div>

        <!-- Transformation Examples -->
        <div class="detail-box">
            <div class="detail-title">üìê Transformation Functions Explained</div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Feature</th>
                        <th>Constraint</th>
                        <th>Transformation</th>
                        <th>Example</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>temperature</strong></td>
                        <td><span class="badge badge-positive">POSITIVE</span></td>
                        <td><code>w = softplus(Œ∏)</code></td>
                        <td>Œ∏ = 0.5</td>
                        <td>w = 1.13 ‚úÖ</td>
                    </tr>
                    <tr>
                        <td><strong>precipitation</strong></td>
                        <td><span class="badge badge-negative">NEGATIVE</span></td>
                        <td><code>w = -softplus(Œ∏)</code></td>
                        <td>Œ∏ = 0.9</td>
                        <td>w = -1.34 ‚úÖ</td>
                    </tr>
                    <tr>
                        <td><strong>gdp_index</strong></td>
                        <td><span class="badge badge-positive">POSITIVE</span></td>
                        <td><code>w = softplus(Œ∏)</code></td>
                        <td>Œ∏ = 2.3</td>
                        <td>w = 10.08 ‚úÖ</td>
                    </tr>
                    <tr>
                        <td><strong>unemployment</strong></td>
                        <td><span class="badge badge-negative">NEGATIVE</span></td>
                        <td><code>w = -softplus(Œ∏)</code></td>
                        <td>Œ∏ = 0.8</td>
                        <td>w = -1.21 ‚úÖ</td>
                    </tr>
                    <tr>
                        <td><strong>price</strong></td>
                        <td><span class="badge badge-negative">NEGATIVE</span></td>
                        <td><code>w = -softplus(Œ∏)</code></td>
                        <td>Œ∏ = -0.5</td>
                        <td>w = -0.47 ‚úÖ</td>
                    </tr>
                    <tr>
                        <td><strong>tv_spend</strong></td>
                        <td><span class="badge badge-positive">POSITIVE</span></td>
                        <td><code>w = softplus(Œ∏)</code></td>
                        <td>Œ∏ = 1.5</td>
                        <td>w = 2.12 ‚úÖ</td>
                    </tr>
                    <tr>
                        <td><strong>discount_pct</strong></td>
                        <td><span class="badge badge-positive">POSITIVE</span></td>
                        <td><code>w = softplus(Œ∏)</code></td>
                        <td>Œ∏ = -1.0</td>
                        <td>w = 0.31 ‚úÖ</td>
                    </tr>
                </tbody>
            </table>

            <div style="margin-top: 20px;">
                <p><strong>What is softplus?</strong></p>
                <div class="code-block">softplus(x) = log(1 + exp(x))

Properties:
  ‚Ä¢ Always positive (output > 0)
  ‚Ä¢ Smooth (differentiable everywhere)
  ‚Ä¢ Behaves like:
    - x < 0 ‚Üí close to 0
    - x = 0 ‚Üí 0.69
    - x > 0 ‚Üí approximately x (linear)
  ‚Ä¢ Gradients: ‚àÇsoftplus/‚àÇx = sigmoid(x)</div>
            </div>
        </div>

        <!-- Future Extensions -->
        <div class="detail-box">
            <div class="detail-title">üöÄ Future Extensions (Advanced Constraints)</div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Extension</th>
                        <th>Description</th>
                        <th>Example Code</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Bounded Weights</strong></td>
                        <td>Enforce specific ranges (e.g., -5 ‚â§ w ‚â§ 0)</td>
                        <td><code>w = min_val + sigmoid(Œ∏) * (max_val - min_val)</code></td>
                    </tr>
                    <tr>
                        <td><strong>Non-linear Elasticity</strong></td>
                        <td>Price weight varies by price level (sigmoid)</td>
                        <td><code>w = -2.0 / (1 + exp(-k * (price - center)))</code></td>
                    </tr>
                    <tr>
                        <td><strong>Feature Interactions</strong></td>
                        <td>TV spend effectiveness depends on distribution</td>
                        <td><code>w_tv = softplus(Œ∏_tv) * (distribution / 100)</code></td>
                    </tr>
                    <tr>
                        <td><strong>Segment-specific</strong></td>
                        <td>Price sensitivity varies by customer segment</td>
                        <td><code>w_price = get_elasticity(Œ∏, segment_embedding)</code></td>
                    </tr>
                    <tr>
                        <td><strong>Temporal Modulation</strong></td>
                        <td>Temperature effect varies by season</td>
                        <td><code>w_temp = softplus(Œ∏) * seasonal_modifier(month)</code></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Comparison Summary -->
        <div class="detail-box">
            <div class="detail-title">üìä Quick Comparison Summary</div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Aspect</th>
                        <th>Standard Linear</th>
                        <th>Constrained Linear</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Weights</strong></td>
                        <td>‚ùå Any value (unconstrained)</td>
                        <td>‚úÖ Respect business logic</td>
                    </tr>
                    <tr>
                        <td><strong>Interpretability</strong></td>
                        <td>‚ö†Ô∏è May violate expectations</td>
                        <td>‚úÖ Always makes business sense</td>
                    </tr>
                    <tr>
                        <td><strong>Training</strong></td>
                        <td>‚úÖ Fast convergence</td>
                        <td>‚ö†Ô∏è Slightly slower (5-15% ‚Üë loss)</td>
                    </tr>
                    <tr>
                        <td><strong>Robustness</strong></td>
                        <td>‚ö†Ô∏è Can overfit to noise</td>
                        <td>‚úÖ More robust (regularization effect)</td>
                    </tr>
                    <tr>
                        <td><strong>Implementation</strong></td>
                        <td>‚úÖ Simple (built-in)</td>
                        <td>‚ö†Ô∏è Custom layer needed</td>
                    </tr>
                    <tr>
                        <td><strong>Extensibility</strong></td>
                        <td>‚ùå Hard to add complex rules</td>
                        <td>‚úÖ Easy to extend (interactions, curves)</td>
                    </tr>
                    <tr>
                        <td><strong>Business Trust</strong></td>
                        <td>‚ùå "Black box" feeling</td>
                        <td>‚úÖ Stakeholder confidence</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Code Example -->
        <div class="detail-box">
            <div class="detail-title">üíª Simplified Code Structure</div>

            <p><strong>Standard Linear Layer:</strong></p>
            <div class="code-block">class StandardModel(nn.Module):
    def __init__(self):
        self.linear = nn.Linear(47, 1)  # Unconstrained weights

    def forward(self, x):
        return self.linear(x)  # W can be any value!</div>

            <p><strong>Constrained Linear Layer:</strong></p>
            <div class="code-block">class ConstrainedLinear(nn.Module):
    def __init__(self, positive_idx, negative_idx):
        self.params = nn.Parameter(torch.randn(47))  # Learn unconstrained Œ∏
        self.bias = nn.Parameter(torch.zeros(1))
        self.pos_idx = positive_idx
        self.neg_idx = negative_idx

    def forward(self, x):
        # Transform parameters ‚Üí valid weights
        weights = self.params.clone()
        weights[self.pos_idx] = F.softplus(weights[self.pos_idx])   # Positive
        weights[self.neg_idx] = -F.softplus(weights[self.neg_idx])  # Negative

        # Standard linear operation with constrained weights
        return (x * weights).sum(dim=1) + self.bias</div>

            <p style="margin-top: 15px;"><strong>Key Difference:</strong> The constrained layer <em>transforms</em> learnable parameters before using them, ensuring constraints are always satisfied!</p>
        </div>
    </div>
</body>

</html>